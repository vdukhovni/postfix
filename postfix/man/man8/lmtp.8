.TH LMTP 8 
.ad
.fi
.SH NAME
lmtp
\-
Postfix local delivery via LMTP
.SH SYNOPSIS
.na
.nf
\fBlmtp\fR [generic Postfix daemon options] [server attributes...]
.SH DESCRIPTION
.ad
.fi
The LMTP client processes message delivery requests from
the queue manager. Each request specifies a queue file, a sender
address, a domain or host to deliver to, and recipient information.
This program expects to be run from the \fBmaster\fR(8) process
manager.

The LMTP client updates the queue file and marks recipients
as finished, or it informs the queue manager that delivery should
be tried again at a later time. Delivery problem reports are sent
to the \fBbounce\fR(8) or \fBdefer\fR(8) daemon as appropriate.

If no server is given on the command line, the LMTP client connects
to the destination specified in the message delivery request and to
the TCP port defined as \fBlmtp\fR in \fBservices\fR(4).  If no such
service is found, the \fBlmtp_tcp_port\fR configuration parameter
(default value of 24) will be used. The LMTP client does not perform
MX (mail exchanger) lookups since those are defined only for SMTP.
.SH SERVER ATTRIBUTE SYNTAX
.na
.nf
.ad
.fi
The server attributes are given in the \fBmaster.cf\fR file at
the end of a service definition.  The syntax is as follows:
.IP "\fBserver=\fR\fIhost\fR"
.IP "\fBserver=\fR\fIhost\fR\fB:\fR\fIport\fR"
.IP "\fBserver=[\fR\fIipaddr\fR\fB]\fR"
.IP "\fBserver=[\fR\fIipaddr\fR\fB]:\fR\fIport\fR"
Connect to the specified host or IP address and TCP port (default: the
\fBlmtp\fR port as specified in the \fBservices\fR database).
.PP
.SH SECURITY
.na
.nf
.ad
.fi
The LMTP client is moderately security-sensitive. It talks to LMTP
servers and to DNS servers on the network. The LMTP client can be
run chrooted at fixed low privilege.
.SH STANDARDS
.na
.nf
RFC 821 (SMTP protocol)
RFC 1651 (SMTP service extensions)
RFC 1870 (Message Size Declaration)
RFC 2033 (LMTP protocol)
RFC 2197 (Pipelining)
.SH DIAGNOSTICS
.ad
.fi
Problems and transactions are logged to \fBsyslogd\fR(8).
Corrupted message files are marked so that the queue manager can
move them to the \fBcorrupt\fR queue for further inspection.

Depending on the setting of the \fBnotify_classes\fR parameter,
the postmaster is notified of bounces, protocol problems, and of
other trouble.
.SH BUGS
.ad
.fi
.SH CONFIGURATION PARAMETERS
.na
.nf
.ad
.fi
The following \fBmain.cf\fR parameters are especially relevant to
this program. See the Postfix \fBmain.cf\fR file for syntax details
and for default values. Use the \fBpostfix reload\fR command after
a configuration change.
.SH Miscellaneous
.ad
.fi
.IP \fBdebug_peer_level\fR
Verbose logging level increment for hosts that match a
pattern in the \fBdebug_peer_list\fR parameter.
.IP \fBdebug_peer_list\fR
List of domain or network patterns. When a remote host matches
a pattern, increase the verbose logging level by the amount
specified in the \fBdebug_peer_level\fR parameter.
.IP \fBerror_notice_recipient\fR
Recipient of protocol/policy/resource/software error notices.
.IP \fBnotify_classes\fR
When this parameter includes the \fBprotocol\fR class, send mail to the
postmaster with transcripts of LMTP sessions with protocol errors.
.IP \fBlmtp_skip_quit_response\fR
Do not wait for the server response after sending QUIT.
.IP \fBlmtp_tcp_port\fR
The TCP port to be used when connecting to a LMTP server.  Used as
backup if the \fBlmtp\fR service is not found in \fBservices\fR(4).
.SH "Resource controls"
.ad
.fi
.IP \fBlmtp_cache_connection\fR
Should we cache the connection to the LMTP server? The effectiveness
of cached connections will be determined by the number of LMTP servers
in use, and the concurrency limit specified for the LMTP client.
Cached connections are closed under any of the following conditions:
.RS
.IP \(bu
The LMTP client idle time limit is reached. This limit is specified
with the Postfix \fBmax_idle\fR configuration parameter.
.IP \(bu
A delivery request specifies a different destination than the one
currently cached.
.IP \(bu
The per-process limit on the number of delivery requests is reached.
This limit is specified with the Postfix \fBmax_use\fR configuration
parameter.
.IP \(bu
Upon the onset of another delivery request, the LMTP server associated
with the current session does not respond to the \fBRSET\fR command.
.RE
.IP \fItransport_\fBdestination_concurrency_limit\fR
Limit the number of parallel deliveries to the same destination
via this mail delivery transport. \fItransport\fR is the name
of the service as specified in the \fBmaster.cf\fR file.
The default limit is taken from the
\fBdefault_destination_concurrency_limit\fR parameter.
.IP \fItransport_\fBdestination_recipient_limit\fR
Limit the number of recipients per message delivery via this mail
delivery transport. \fItransport\fR is the name
of the service as specified in the \fBmaster.cf\fR file.
The default limit is taken from the
\fBdefault_destination_recipient_limit\fR parameter.

This parameter becomes significant if the LMTP client is used
for local delivery.  Some LMTP servers can optimize delivery of
the same message to multiple recipients. The default limit for
local mail delivery is 1.

Setting this parameter to 0 will lead to an unbounded number of
recipients per delivery.  However, this could be risky since it may
make the machine vulnerable to running out of resources if messages
are encountered with an inordinate number of recipients.  Exercise
care when setting this parameter.
.SH "Timeout controls"
.ad
.fi
.IP \fBlmtp_connect_timeout\fR
Timeout in seconds for opening a connection to the LMTP server.
If no connection can be made within the deadline, the message
is deferred.
.IP \fBlmtp_lhlo_timeout\fR
Timeout in seconds for sending the \fBLHLO\fR command, and for
receiving the server response.
.IP \fBlmtp_mail_timeout\fR
Timeout in seconds for sending the \fBMAIL FROM\fR command, and for
receiving the server response.
.IP \fBlmtp_rcpt_timeout\fR
Timeout in seconds for sending the \fBRCPT TO\fR command, and for
receiving the server response.
.IP \fBlmtp_data_init_timeout\fR
Timeout in seconds for sending the \fBDATA\fR command, and for
receiving the server response.
.IP \fBlmtp_data_xfer_timeout\fR
Timeout in seconds for sending the message content.
.IP \fBlmtp_data_done_timeout\fR
Timeout in seconds for sending the "\fB.\fR" command, and for
receiving the server response. When no response is received, a
warning is logged that the mail may be delivered multiple times.
.IP \fBlmtp_rset_timeout\fR
Timeout in seconds for sending the \fBRSET\fR command, and for
receiving the server response.
.IP \fBlmtp_quit_timeout\fR
Timeout in seconds for sending the \fBQUIT\fR command, and for
receiving the server response.
.SH SEE ALSO
.na
.nf
bounce(8) non-delivery status reports
local(8) local mail delivery
master(8) process manager
qmgr(8) queue manager
services(4) Internet services and aliases
spawn(8) auxiliary command spawner
syslogd(8) system logging
.SH LICENSE
.na
.nf
.ad
.fi
The Secure Mailer license must be distributed with this software.
.SH AUTHOR(S)
.na
.nf
Wietse Venema
IBM T.J. Watson Research
P.O. Box 704
Yorktown Heights, NY 10598, USA

Alterations for LMTP by:
Philip A. Prindeville
Mirapoint, Inc.
USA.

Additional work on LMTP by:
Amos Gouaux
University of Texas at Dallas
P.O. Box 830688, MC34
Richardson, TX 75083, USA
